> 教材第十一章

- 哈希函数是密码学中的一类原语
- 哈希函数的安全要求：单向性，抗碰撞
- 了解常用哈希函数的消息长度是多少

## 密码学中哈希函数的应用

### 消息认证

![](_images/summary-hash-functions-1.png ':class=resizedImage')

上图过程无法抵抗中间人攻击，因此要想办法防止攻击者生成能被认证通过的哈希值（教材 P236）。一般消息认证是通过使用消息认证码实现的，即带密钥的哈希函数，在下一章。

### 数字签名

在进行数字签名过程中**使用用户的私钥加密消息的哈希值**。

## 需求和安全性

![](_images/summary-hash-functions-2.png ':class=resizedImage')

- 碰撞攻击穷举的规模比原像攻击和第二原像攻击更小（由生日悖论可印证）
- 穷举攻击，密码分析

### 安全哈希码

![](_images/summary-hash-functions-4.png ':class=resizedImage')

SHA 在内的目前所使用的大多数 Hash 函数都是这种结构。Hash 函数将输入消息分为 $L$ 个固定长度的分组，每一分组长为 $b$ 位，最后一个分组不足 $b$ 位时需要将其填充为 $b$ 位，最后一个分组包含输入的总长度。<span style="color: #8590a6">（由于输入中包含长度，所以攻击者必须找出具有相同 Hash 值且长度相等的两条消息，或者找出两条长度不等但加入消息长度后 Hash 值相同的消息，从而增加了攻击的难度）</span>

Hash 函数中重复使用了**压缩函数** $f$，它的输入包括两部分：前一步中得出的 $n$ 位结果（称为链接变量）和一个 $b$ 位分组，输出为一个 $n$ 位分组。链接变量的初值由算法在开始时指定，其终值即为 Hash 值，通常 $b>n$ ，因此称为压缩。（[实验五]((course/cryptography/lab-5.md))应用了此结构）

## 安全哈希算法（SHA）

![](_images/summary-hash-functions-3.png ':class=resizedImage')

## 思考题

<!-- tabs:start -->

### ** 11.1 & 11.2 **

> 安全 Hash 函数需要具有哪些特性？

> 抗弱碰撞和抗强碰撞之间的区别是什么？

上方截图。

### ** 11.3 **

> Hash 函数中的压缩函数的作用是什么？

得到固定的输出长度。

### ** 11.5 **

> SHA 中使用的基本算术和逻辑函数是什么？

模 $2^{64}$ 或 $2^{32}$ 加，循环移位，与，或，非，异或。

<!-- tabs:end -->